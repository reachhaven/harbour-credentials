id: https://w3id.org/reachhaven/harbour/gaiax-domain/v1
name: gaiax-domain
description: >
  Gaia-X domain layer for Harbour credentials.
  Defines participant and service offering types that wrap Gaia-X
  compliance data via composition. Harbour outer nodes carry
  harbour-specific properties; nested gx blank nodes carry only gx
  properties, keeping gx closed SHACL shapes intact.

prefixes:
  linkml: https://w3id.org/linkml/
  harbour: https://w3id.org/reachhaven/harbour/credentials/v1/
  core: https://w3id.org/reachhaven/harbour/core/v1/
  xsd: http://www.w3.org/2001/XMLSchema#
  cred: https://www.w3.org/2018/credentials#
  schema: http://schema.org/

default_prefix: harbour
default_range: string

imports:
  - linkml:types
  - ./harbour

# ==========================================
# Composition Slots
# ==========================================
# These slots link harbour outer nodes to Gaia-X inner blank nodes.
# Design: Gaia-X Trust Framework defines closed SHACL shapes on gx: types.
#   Harbour cannot add properties to gx nodes without violating sh:closed.
#   Solution: composition — harbour outer node owns harbour properties;
#   nested gx blank node carries only gx properties.
# Spec: Gaia-X Trust Framework 22.10 — gx:LegalPerson, gx:Participant,
#   gx:ServiceOffering are closed SHACL shapes requiring specific properties.

slots:
  gxParticipant:
    description: >
      Nested Gaia-X participant compliance data
      (gx:LegalPerson or gx:Participant blank node).
    slot_uri: harbour:gxParticipant
    range: Any
    required: false

  gxServiceOffering:
    description: >
      Nested Gaia-X service offering compliance data
      (gx:ServiceOffering blank node).
    slot_uri: harbour:gxServiceOffering
    range: Any
    required: false

classes:
  # ==========================================
  # 1. PARTICIPANT TYPES
  # ==========================================
  # Harbour wraps Gaia-X participant types via composition.
  # Gaia-X data lives in nested blank nodes (gxParticipant /
  # gxServiceOffering) to keep gx closed shapes intact.
  # Spec: Gaia-X TF — gx:LegalPerson requires gx:registrationNumber (object),
  #   gx:headquartersAddress, gx:legalAddress. gx:Participant is the base type.

  LegalPerson:
    description: >
      A legal person (organization) participating in the harbour ecosystem.
      Gaia-X compliance data is nested in the gxParticipant slot as a
      gx:LegalPerson blank node, keeping the gx closed shape intact.
    class_uri: harbour:LegalPerson
    slots:
      # Spec: schema.org — schema:name for human-readable organization name.
      #   NOTE: gx:legalName is NOT a valid gx:LegalPerson property in current
      #   Gaia-X shapes. Use schema:name on the harbour outer node instead.
      - name
      - gxParticipant
    slot_usage:
      name:
        required: true

  NaturalPerson:
    description: >
      A natural person (individual) participating in the harbour ecosystem.
      Gaia-X participant data is nested in the gxParticipant slot.
    class_uri: harbour:NaturalPerson
    slots:
      - name
      - gxParticipant
    slot_usage:
      name:
        required: true
    attributes:
      # Spec: schema.org Person vocabulary — givenName, familyName, email.
      givenName:
        slot_uri: schema:givenName
        range: string
      familyName:
        slot_uri: schema:familyName
        range: string
      email:
        slot_uri: schema:email
        range: string
      # Spec: schema.org — memberOf relates Person to Organization.
      memberOf:
        description: Organization (LegalPerson) the natural person belongs to.
        slot_uri: schema:memberOf
        range: uri

  ServiceOffering:
    description: >
      A service offering available in the harbour ecosystem.
      Gaia-X compliance data is nested in the gxServiceOffering slot.
    class_uri: harbour:ServiceOffering
    slots:
      - name
      - description
      - gxServiceOffering
    slot_usage:
      name:
        required: true

  # ==========================================
  # 2. CREDENTIAL TYPES
  # ==========================================
  # Spec: VCDM2 §4 — each credential MUST have @context, type, issuer,
  #   credentialSubject. Harbour profile additionally requires validFrom
  #   and credentialStatus (inherited from HarbourCredential).
  # Spec: SD-JWT-VC draft-14 — uses vct claim instead of type array.
  #   Harbour claim_mapping.py bridges W3C ↔ SD-JWT-VC formats.

  LegalPersonCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a harbour:LegalPerson (organization) identity.
      The credentialSubject wraps a gx:LegalPerson via the gxParticipant slot.
    class_uri: harbour:LegalPersonCredential
    slot_usage:
      validFrom:
        required: true
      # Evidence REQUIRED: Trust Anchor authorizes issuance via VP containing
      # its self-signed LegalPersonCredential (root of trust).
      evidence:
        required: true

  NaturalPersonCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a harbour:NaturalPerson (individual) identity.
      The credentialSubject wraps gx:Participant via the gxParticipant slot.
    class_uri: harbour:NaturalPersonCredential
    slot_usage:
      validFrom:
        required: true
      # Evidence REQUIRED: organization authorizes issuance via VP containing
      # its LegalPersonCredential (SD-JWT, sensitive fields redacted).
      evidence:
        required: true

  ServiceOfferingCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a harbour:ServiceOffering.
      The credentialSubject wraps a gx:ServiceOffering via the
      gxServiceOffering slot.
    class_uri: harbour:ServiceOfferingCredential
    slot_usage:
      validFrom:
        required: true
