id: https://w3id.org/reachhaven/harbour/credentials/v1
name: harbour
description: >
  LinkML schema for Harbour credentials vocabulary.
  Defines constraints on the W3C VC envelope (cred:), evidence types,
  status, trust anchors, and revocation registries.

prefixes:
  linkml: https://w3id.org/linkml/
  harbour: https://w3id.org/reachhaven/harbour/credentials/v1/
  core: https://w3id.org/reachhaven/harbour/core/v1/
  gx: https://w3id.org/gaia-x/development#
  xsd: http://www.w3.org/2001/XMLSchema#
  cs: https://www.w3.org/ns/credentials/status#
  cred: https://www.w3.org/2018/credentials#
  schema: http://schema.org/
  did: https://www.w3.org/ns/did#

default_prefix: harbour
default_range: string

imports:
  - linkml:types
  - ./core
  - ../submodules/service-characteristics/linkml/gaia-x

slots:
  # --- DID Slots ---
  controller:
    slot_uri: https://www.w3.org/ns/did#controller
    range: string

  serviceEndpoint:
    slot_uri: https://www.w3.org/ns/did#serviceEndpoint
    range: Any
    required: true

  # --- Revocation Registry (CRSet) Slots ---
  statusPurpose:
    slot_uri: cs:statusPurpose
    range: string
    required: false

  registryEndpoint:
    description: Service endpoint IRI for the CRSet.
    slot_uri: harbour:registryEndpoint
    range: uri
    required: false

  contractURN:
    slot_uri: harbour:contractURN
    range: uri
    required: false

  sourceRepository:
    slot_uri: harbour:sourceRepository
    range: uri
    required: false

  implementation:
    slot_uri: harbour:implementation
    range: uri
    required: false

  # --- Trust Anchor / Organization Slots ---
  contactType:
    slot_uri: schema:contactType
    range: string

  name:
    description: A human-readable name for the entity.
    slot_uri: schema:name
    range: string

  description:
    description: A human-readable description of the entity.
    slot_uri: schema:description
    range: string

  url:
    description: A URL associated with the entity.
    slot_uri: schema:url
    range: uri

  email:
    description: An email address.
    slot_uri: schema:email
    range: string

  contactPoint:
    description: A contact point for the entity.
    slot_uri: schema:contactPoint
    range: string

  # --- Credential / Evidence Slots ---
  evidence:
    slot_uri: cred:evidence
    range: Evidence
    multivalued: true
    required: false

  verifiablePresentation:
    description: >
      A Verifiable Presentation embedded as evidence. In examples this is
      shown as expanded JSON-LD for readability; on the wire it is encoded
      as a VC-JOSE-COSE compact JWS string (typ: vp+ld+jwt).
    slot_uri: harbour:verifiablePresentation
    range: Any
    required: false

  vp:
    description: >
      DEPRECATED: Use verifiablePresentation instead.
      A Verifiable Presentation embedded as evidence (nested JSON-LD object).
    slot_uri: harbour:vp
    range: Any
    required: false

  # --- W3C VC v2 Envelope Slots (harbour constrains these) ---
  validFrom:
    slot_uri: cred:validFrom
    range: datetime
    required: true

  validUntil:
    slot_uri: cred:validUntil
    range: datetime
    required: false

classes:
  Any:
    class_uri: linkml:Any
    description: "Generic class for any type of value."

  # TermsAndConditions is defined upstream in Gaia-X service-offering.yaml
  # with url (gx:url) and hash (gx:hash) slots â€” reused as-is.

  # ==========================================
  # 1. ROOT DOCUMENT
  # ==========================================
  DIDDocument:
    class_uri: https://www.w3.org/ns/did#DIDDocument
    slots:
      - id
      - controller
    attributes:
      service:
        slot_uri: https://www.w3.org/ns/did#service
        multivalued: true
        inlined: true
        range: ServiceUnion
      verificationMethod:
        slot_uri: https://www.w3.org/ns/did#verificationMethod
        multivalued: true
        range: VerificationMethod

  # ==========================================
  # 2. SERVICES
  # ==========================================
  ServiceUnion:
    union_of:
      - TrustAnchorService
      - CRSetRevocationRegistryService

  TrustAnchorService:
    class_uri: harbour:TrustAnchorService
    slots:
      - id
      - type
      - serviceEndpoint
    slot_usage:
      serviceEndpoint:
        range: OrganizationEndpoint
        inlined: true

  OrganizationEndpoint:
    class_uri: schema:Organization
    slots:
      - name
      - url
      - description
      - contactPoint
    slot_usage:
      contactPoint:
        range: ContactPoint
        inlined: true

  ContactPoint:
    class_uri: schema:ContactPoint
    slots:
      - contactType
      - email

  CRSetRevocationRegistryService:
    class_uri: harbour:CRSetRevocationRegistryService
    slots:
      - id
      - type
      - serviceEndpoint
    slot_usage:
      serviceEndpoint:
        range: CRSetServiceEndpoint
        inlined: true

  CRSetServiceEndpoint:
    class_uri: harbour:CRSetServiceEndpoint
    slots:
      - registryEndpoint
      - statusPurpose
      - contractURN
      - sourceRepository
      - implementation

  # ==========================================
  # 3. PARTICIPANT TYPES
  # ==========================================
  # Harbour provides abstraction layers over Gaia-X participant types.
  # In JSON-LD credentials, use both harbour: and gx: types for compatibility.

  LegalPerson:
    description: >
      A legal person (organization) that is onboarded to Gaia-X.
      This harbour abstraction wraps gx:LegalPerson for consistency.
      In JSON-LD credentials, use type: ["harbour:LegalPerson", "gx:LegalPerson"]
      to indicate compatibility with Gaia-X.
    class_uri: harbour:LegalPerson
    slots:
      - name
      - description
    attributes:
      legalName:
        description: The official legal name of the organization.
        slot_uri: gx:legalName
        range: string
      registrationNumber:
        description: Registration number identifying the legal entity.
        slot_uri: gx:registrationNumber
        range: string
      headquartersAddress:
        description: Physical location of the headquarters.
        slot_uri: gx:headquartersAddress
        range: string
      legalAddress:
        description: Official legal address of the organization.
        slot_uri: gx:legalAddress
        range: string

  NaturalPerson:
    description: >
      A natural person (individual) that is onboarded to Gaia-X.
      This is a harbour placeholder for gx:NaturalPerson until Gaia-X
      officially adds the class (ref: service-characteristics#350).
      In JSON-LD credentials, use type: ["harbour:NaturalPerson", "gx:Participant"]
      to indicate compatibility with gx:Participant.
    class_uri: harbour:NaturalPerson
    slots:
      - name
      - description
    attributes:
      givenName:
        slot_uri: schema:givenName
        range: string
      familyName:
        slot_uri: schema:familyName
        range: string
      email:
        slot_uri: schema:email
        range: string

  ServiceOffering:
    description: >
      A service offering that can be consumed within Gaia-X.
      This harbour abstraction wraps gx:ServiceOffering for consistency.
      In JSON-LD credentials, use type: ["harbour:ServiceOffering", "gx:ServiceOffering"]
      to indicate compatibility with Gaia-X.
    class_uri: harbour:ServiceOffering
    slots:
      - name
      - description
    attributes:
      providedBy:
        description: Reference to the provider (LegalPerson) of this service.
        slot_uri: gx:providedBy
        range: uri
      termsAndConditions:
        description: Terms and conditions for this service offering.
        slot_uri: gx:serviceOfferingTermsAndConditions
        range: string

  # ==========================================
  # 4. CREDENTIAL TYPES
  # ==========================================
  # Harbour credential types add mandatory credentialStatus (CRSetEntry)
  # and optional evidence to W3C VerifiableCredential.

  HarbourCredential:
    abstract: true
    description: >
      Abstract base for all Harbour credentials. Requires validFrom and
      credentialStatus with at least one CRSetEntry for revocation support.
    class_uri: harbour:HarbourCredential
    slots:
      - id
      - type
      - validFrom
      - validUntil
      - evidence
    attributes:
      credentialStatus:
        slot_uri: cred:credentialStatus
        range: CRSetEntry
        multivalued: true
        required: true
        description: Status entries for revocation checking (CRSet).

  LegalPersonCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a gx:LegalPerson (organization) identity.
      The credentialSubject contains a gx:LegalPerson with registration
      number, addresses, and organizational details.
    class_uri: harbour:LegalPersonCredential

  NaturalPersonCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a harbour:NaturalPerson (individual) identity.
      The credentialSubject contains personal information like name and email.
    class_uri: harbour:NaturalPersonCredential

  ServiceOfferingCredential:
    is_a: HarbourCredential
    description: >
      Credential attesting to a gx:ServiceOffering.
      The credentialSubject describes a service with its provider,
      terms and conditions, and service characteristics.
    class_uri: harbour:ServiceOfferingCredential

  # ==========================================
  # 5. EVIDENCE TYPES
  # ==========================================
  Evidence:
    abstract: true
    class_uri: cred:Evidence
    slots:
      - type

  EmailVerification:
    is_a: Evidence
    description: Evidence that an email address was verified (e.g. via Altme EmailPass).
    class_uri: harbour:EmailVerification
    slots:
      - verifiablePresentation

  IssuanceEvidence:
    is_a: Evidence
    description: Evidence referencing a previously issued credential.
    class_uri: harbour:IssuanceEvidence
    slots:
      - verifiablePresentation

  CRSetEntry:
    class_uri: harbour:CRSetEntry
    slots:
      - id
      - type
      - statusPurpose

  # ==========================================
  # 6. HELPERS
  # ==========================================
  VerificationMethod:
    class_uri: https://www.w3.org/ns/did#VerificationMethod
    slots:
      - id
      - type
      - controller
    attributes:
      blockchainAccountId:
        range: string
